{
    "blacklisted_images": [], 
    "comment": "NGC External Policy", 
    "id": "E583C57E-0F3F-491C-B976-F48B9EF93B13", 
    "mappings": [
        {
            "id": "70a60b83-ba8f-45b7-970a-c811be088a8c", 
            "image": {
                "type": "tag", 
                "value": "*"
            }, 
            "name": "default", 
            "policy_id": "cf56a918-a2be-4a2a-a707-d99c46af9424", 
            "registry": "*", 
            "repository": "*", 
            "whitelist_ids": [
                "37fd763e-1765-11e8-add4-3b16c029ac5c",
                "2cedec50-2dd9-4b0a-85ec-52dbfa62201b"
            ]
        }
    ], 
    "name": "NGC External Policy", 
    "policies": [
        {
            "comment": "External policy for NGC container images scans", 
            "id": "cf56a918-a2be-4a2a-a707-d99c46af9424", 
            "name": "ExternalPolicy", 
            "rules": [
                {
                    "action": "STOP", 
                    "gate": "dockerfile", 
                    "id": "cf56a918-a2be-4a2a-a707-d99c46af9424", 
                    "params": [
                        {
                            "name": "ports", 
                            "value": "20,23,25,80,115"
                        }, 
                        {
                            "name": "type", 
                            "value": "blacklist"
                        }
                    ], 
                    "trigger": "exposed_ports"
                },  
                {
                    "action": "WARN", 
                    "gate": "metadata", 
                    "id": "bce7d46a-ae3c-4087-956d-abb87cdf4eff", 
                    "params": [
                        {
                            "name": "attribute", 
                            "value": "size"
                        },
                        {
                            "name": "check", 
                            "value": ">"
                        },
                        {
                            "name": "value", 
                            "value": "3741824"
                        }
                    ], 
                    "trigger": "attribute"
                },
                {
                    "action": "WARN", 
                    "gate": "passwd_file", 
                    "id": "bbdceb65-be6c-4748-bc96-62accf2c7d7a", 
                    "params": [
                        {
                            "name": "user_names", 
                            "value": "root"
                        }
                    ], 
                    "trigger": "blacklist_usernames"
                },
                {
                    "action": "STOP", 
                    "gate": "secret_scans", 
                    "id": "1405a381-7572-4650-b457-6ec431dbab68", 
                    "params": [
                        {
                            "name": "content_regex_name", 
                            "value": "AWS_ACCESS_KEY"
                        },
                        {
                            "name": "filename_regex",
                            "value": "(?i)^(?:(?!test)(?!/examples/)(?!/h2demo/).)*$"
                        }
                    ], 
                    "trigger": "content_regex_checks"
                },
                {
                    "action": "STOP", 
                    "gate": "secret_scans", 
                    "id": "2a78f23e-37b2-44aa-ac31-1ef9240b270e", 
                    "params": [
                        {
                            "name": "content_regex_name", 
                            "value": "AWS_SECRET_KEY"
                        },
                        {
                            "name": "filename_regex",
                            "value": "(?i)^(?:(?!test)(?!/examples/)(?!/h2demo/).)*$"
                        }
                    ], 
                    "trigger": "content_regex_checks"
                },
                {
                    "action": "STOP", 
                    "gate": "secret_scans", 
                    "id": "de89be82-f341-4790-8aa3-c81f0c35a4b7", 
                    "params": [
                        {
                            "name": "content_regex_name", 
                            "value": "PRIV_KEY"
                        },
                        {
                        	"name": "filename_regex",
                        	"value": "(?i)^(?:(?!test)(?!/examples/)(?!/h2demo/).)*$"
                        }
                    ], 
                    "trigger": "content_regex_checks"
                },
                {
                    "action": "STOP", 
                    "gate": "secret_scans", 
                    "id": "d7bb8fe7-184a-402a-8d1b-26f82d8eb7f8", 
                    "params": [
                        {
                            "name": "content_regex_name", 
                            "value": "DOCKER_AUTH"
                        },
                        {
                            "name": "filename_regex",
                            "value": "(?i)^(?:(?!test)(?!/examples/)(?!/h2demo/).)*$"
                        }
                    ], 
                    "trigger": "content_regex_checks"
                },
                {
                    "action": "STOP", 
                    "gate": "secret_scans", 
                    "id": "f3a4223f-5874-41ba-af8c-bef59d158b9e", 
                    "params": [
                        {
                            "name": "content_regex_name", 
                            "value": "API_KEY"
                        },
                        {
                            "name": "filename_regex",
                            "value": "(?i)^(?:(?!test)(?!/examples/)(?!/h2demo/).)*$"
                        }
                    ], 
                    "trigger": "content_regex_checks"
                },
                {
                    "action": "STOP", 
                    "gate": "vulnerabilities", 
                    "id": "ddad9dbf-f991-4b05-8088-63aeb7b5d261", 
                    "params": [
                        {
                            "name": "max_days_since_sync", 
                            "value": "2"
                        }
                    ], 
                    "trigger": "stale_feed_data"
                }, 
                {
                    "action": "STOP", 
                    "gate": "vulnerabilities", 
                    "id": "3e79ea94-18c4-4d26-9e29-3b9172a62c2e", 
                    "params": [], 
                    "trigger": "vulnerability_data_unavailable"
                }, 
                {
                    "action": "WARN", 
                    "gate": "vulnerabilities", 
                    "id": "6063fdde-b1c5-46af-973a-915739451ac4", 
                    "params": [
                        {
                            "name": "package_type", 
                            "value": "all"
                        }, 
                        {
                            "name": "severity_comparison", 
                            "value": "="
                        }, 
                        {
                            "name": "severity", 
                            "value": "medium"
                        }
                    ], 
                    "trigger": "package"
                }, 
                {
                    "action": "STOP", 
                    "gate": "vulnerabilities", 
                    "id": "b30e8abc-444f-45b1-8a37-55be1b8c8bb5", 
                    "params": [
                        {
                            "name": "package_type", 
                            "value": "all"
                        }, 
                        {
                            "name": "severity_comparison", 
                            "value": ">"
                        }, 
                        {
                            "name": "severity", 
                            "value": "medium"
                        }
                    ], 
                    "trigger": "package"
                }
            ], 
            "version": "1_0"
        }
    ], 
    "version": "1_0", 
    "whitelisted_images": [], 
    "whitelists": [
        {
            "comment": "Anchore example of whitelisting known derived packages that contain only development headers but may trigger as vulnerable as they are associated with the packages that contain the software itself", 
            "id": "2cedec50-2dd9-4b0a-85ec-52dbfa62201b", 
            "items": [
                {
                    "gate": "vulnerabilities", 
                    "id": "1409ebfd-7aec-44e8-bb27-73a3b97ba16b", 
                    "trigger_id": "*+linux-headers-*"
                },
                {
                    "gate": "vulnerabilities", 
                    "id": "40d95b5e-f7e9-46ee-8d51-59996529ce29", 
                    "trigger_id": "*kernel-debug*"
                },
                {
                    "gate": "vulnerabilities",
                    "id": "8DC93FE4-871A-4904-9BB5-2CE37CDD44B7",
                    "trigger_id": "*kernel-headers*"
                },
                {
                    "gate": "vulnerabilities", 
                    "id": "45925fb3-c7ac-4ceb-9e9f-a6402f798f1f", 
                    "trigger_id": "*+*-dev"
                },
                {
                    "gate": "vulnerabilities",
                    "id": "7f8a9d30-192c-4d04-80d4-f7597c7e86d0",
                    "trigger_id": "*dbus*"
                }
            ], 
            "name": "Development OS Packages", 
            "version": "1_0"
        },
        {
            "comment": "NV crypto material leak check whitelist", 
            "id": "37fd763e-1765-11e8-add4-3b16c029ac5c", 
            "items": [
                {
                    "gate": "secret_scans", 
                    "id": "267ecc37-16c9-46e7-a3cd-e1e8d6000be1", 
                    "trigger_id": "77d9bd0aec7fb9c472fd666ae03940c8"
                },
                {
                    "gate": "secret_scans", 
                    "id": "267ecc37-16c9-46e7-a3cd-e1e8d6000be1", 
                    "trigger_id": "b0bf800bc47efb41a6618ae90d616434"
                },
                {
                    "gate": "secret_scans", 
                    "id": "267ecc37-16c9-46e7-a3cd-e1e8d6000be1", 
                    "trigger_id": "07971e3d4abbb6ac5e1cbce14a0abd9a"
                },               
                {
                   "gate": "secret_scans",
                   "id": "cf56a918-a2be-4a2a-a707-d99c46af9424",
                   "trigger_id": "8673f532175a1203d1533405b198ef89"
                }               
            ],
            "name": "NV_Crypto_Leak_Whitelist", 
            "version": "1_0"
        }
    ]
}

